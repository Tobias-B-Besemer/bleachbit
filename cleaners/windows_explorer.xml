<?xml version="1.0" encoding="UTF-8"?>
<!--

    BleachBit
    Copyright (C) 2008-2019 Andrew Ziem
    https://www.bleachbit.org

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>.

    @app Microsoft Windows Explorer
    @url https://www.microsoft.com/en-us/windows
    @os Windows
    @cleanerversion v1.5.0
    @cleanerdate 2019-03-13
    @cleanerby ??? & https://github.com/Tobias-B-Besemer
    @tested ok v???, Windows 7
    @testeddate 2019-03-10
    @testedby https://github.com/Tobias-B-Besemer
    @note 

-->
<cleaner id="windows_explorer" os="windows">
  <label>Windows Explorer</label>
  <description>File manager</description>
  <option id="mru">
    <label>Most recently used</label>
    <description>Delete the most recently used list</description>
    <!-- applications executed including date and time, Windows XP -->
    <action command="winreg" path="HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist\{5E6AB780-7743-11CF-A12B-00AA004AE837}\Count"/>
    <action command="winreg" path="HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist\{75048700-EF1F-11D0-9888-006097DEACF9}\Count"/>
    <!-- applications executed including date and time, Windows 7 -->
    <action command="winreg" path="HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist\{CEBFF5CD-ACE2-4F4F-9178-9926F41749EA}\Count"/>
    <action command="winreg" path="HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\UserAssist\{F4E57C4B-2036-45F0-A9AB-443BCFE33D9F}\Count"/>
    <!-- refresh Windows shell after UserAssist -->
    <action command="win.shell.change.notify"/>
    <!-- reference: reference: http://support.microsoft.com/kb/142298 -->
    <!-- common open dialog -->
    <action command="winreg" path="HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\LastVisitedMRU"/>
    <!-- Windows Vista/7 -->
    <action command="winreg" path="HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\LastVisitedPidlMRU"/>
    <!-- common save as dialog -->
    <action command="winreg" path="HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\OpenSaveMRU"/>
    <!-- Windows Vista/7 -->
    <action command="winreg" path="HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\OpenSavePidlMRU"/>
    <!-- find files command -->
    <action command="winreg" path="HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Doc Find Spec MRU"/>
    <!-- find Computer command -->
    <action command="winreg" path="HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\FindComputerMRU"/>
    <!-- map network drives -->
    <action command="winreg" path="HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Map Network Drive MRU"/>
    <!-- printer ports -->
    <action command="winreg" path="HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\PrnPortsMRU"/>
    <!-- more MRUs -->
    <!--
    If CCleaner deletes HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32 complete, we can be generous! ;-) Tobias.
     -> Beginning... -->
    <action command="winreg" path="HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\CIDSizeMRU"/>
    <action command="winreg" path="HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\FirstFolder"/>
    <action command="winreg" path="HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\LastVisitedPidlMRULegacy"/>
    <!-- End! -->
    <action command="winreg" path="HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\ComputerDescriptions"/>
    <action command="winreg" path="HKLM\Software\Microsoft\Direct3D\MostRecentApplication" name="Name"/>
    <action command="winreg" path="HKCU\Software\Microsoft\Direct3D\MostRecentApplication" name="Name"/>
    <action command="winreg" path="HKLM\Software\Microsoft\DirectDraw\MostRecentApplication"/>
    <action command="winreg" path="HKCU\Software\Microsoft\DirectInput\MostRecentApplication" name="Id"/>
    <action command="winreg" path="HKCU\Software\Microsoft\DirectInput\MostRecentApplication" name="Name"/>
    <action command="winreg" path="HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\TypedPaths"/>
    <action command="winreg" path="HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Wallpaper\MRU"/>
    <action command="winreg" path="HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Wallpapers\Images"/>
    <action command="winreg" path="HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Wallpapers" name="BackgroundHistoryPath0"/>
    <action command="winreg" path="HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Wallpapers" name="BackgroundHistoryPath1"/>
    <action command="winreg" path="HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Wallpapers" name="BackgroundHistoryPath2"/>
    <action command="winreg" path="HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Wallpapers" name="BackgroundHistoryPath3"/>
    <action command="winreg" path="HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Wallpapers" name="BackgroundHistoryPath4"/>
    <action command="winreg" path="HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\RunMRU"/>
    <action command="winreg" path="HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\StreamMRU"/>
    <action command="winreg" path="HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\Streams"/>
    <action command="winreg" path="HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\TypedPaths"/>
    <action command="winreg" path="HKCU\Software\Microsoft\Windows\ShellNoRoam\MUICache"/>
    <action command="winreg" path="HKCU\Software\Classes\Local Settings\Software\Microsoft\Windows\Shell\MuiCache"/>
  </option>
  <option id="recent_documents">
    <label>Recent documents list</label>
    <description>Delete the list of recently used documents</description>
    <warning>This option will reset pinned locations in Quick Access to their defaults.</warning>
    <!-- Windows XP -->
    <action command="delete" search="glob" path="%USERPROFILE%\Recent\*.lnk"/>
    <!-- Vista and above -->
    <action command="delete" search="glob" path="%APPDATA%\Microsoft\Windows\Recent\*.lnk"/>
    <!-- Recent documents in start menu -->
    <action command="winreg" path="HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\RecentDocs"/>
    <!-- Windows 7 jump list -->
    <action command="delete" search="glob" path="%APPDATA%\Microsoft\Windows\Recent\AutomaticDestinations\*.automaticDestinations-ms"/>
    <action command="delete" search="glob" path="%APPDATA%\Microsoft\Windows\Recent\CustomDestinations\*customDestinations-ms"/>
  </option>
  <option id="run">
    <label translators="In Windows 'Run' is the dialog in the Start menu">Run</label>
    <description>Delete the most recently used list</description>
    <!--  run command -->
    <action command="winreg" path="HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\RunMRU"/>
  </option>
  <option id="search_history">
    <label>Search history</label>
    <description>Delete the search history</description>
    <action command="winreg" path="HKCU\Software\Microsoft\Search Assistant\ACMru"/>
    <!-- Windows 10 -->
    <action command="winreg" path="HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\WordWheelQuery"/>
  </option>
  <option id="thumbnails">
    <label>Thumbnails</label>
    <description>Delete the cache</description>
    <warning>This will restart Windows Explorer.</warning>
    <action command="process" cmd="taskkill.exe /f /IM explorer.exe"/>
    <action command="delete" search="glob" path="%LOCALAPPDATA%\Microsoft\Windows\Explorer\thumbcache*.db"/>
    <!-- On 64-bit Windows, it is important to start the 64-bit Windows Explorer,
         so use the full path. Also, do not wait for the process to terminate.

         The redundant .exe is intentional to launch explorer.exe in disabled UAC
         virtualization mode rather than elevated mode because normally it
         inherits the mode from bleachbit.exe.
     -->
    <action command="process" wait="false" cmd="%WINDIR%\explorer.exe %WINDIR%\explorer.exe"/>
    <action command="delete" search="walk.files" path="%LOCALAPPDATA%\Microsoft\Windows\Explorer\ThumbCacheToDelete\"/>
    <action command="delete" search="file" path="%LOCALAPPDATA%\IconCache.db"/>
    <action command="delete" search="file" path="%LOCALAPPDATA%\IconCache.db.backup"/>
  </option>
  <option id="mountpoints2">
    <label>Mount Points</label>
    <description>Delete the files</description>
    <warning>This will delete your old Mount Points. Only delete if you know what you are doing!</warning>
    <action command="winreg" path="HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\MountPoints2"/>
  </option>
</cleaner>
